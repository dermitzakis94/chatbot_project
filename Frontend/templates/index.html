<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î’Î¿Î·Î¸Î¿Ï</title>
  <style>
    body{font-family:Arial,sans-serif;background-color:#f0f2f5;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;transition:background-color .5s ease}
    .form-container{background:#fff;padding:40px;border-radius:10px;box-shadow:0 4px 20px rgba(0,0,0,.1);width:100%;max-width:600px;box-sizing:border-box;position:relative}
    h2{color:#2e7d32;text-align:center;margin-bottom:20px}
    label{display:block;margin-top:15px;margin-bottom:5px;font-weight:bold;color:#4caf50}
    input[type="text"],input[type="url"],textarea,input[type="file"],select{width:100%;padding:12px;border:1px solid #ccc;border-radius:8px;box-sizing:border-box;font-size:16px;transition:border-color .3s}
    input:focus,textarea:focus,select:focus{border-color:#4caf50;outline:none}
    textarea{resize:vertical;min-height:100px}
    .form-page{display:none;animation:fadeIn .5s ease-in-out}
    .form-page.active{display:block}
    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    button{background:#4caf50;color:#fff;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-size:16px;margin-top:20px;transition:background-color .3s}
    button:hover{background:#388e3c}
    .button-group{display:flex;justify-content:space-between;gap:10px}
    .button-group button{flex:1}
    .prev-btn{background:#616161}
    .prev-btn:hover{background:#424242}
    .steps-indicator{display:flex;justify-content:center;margin-bottom:30px}
    .step{height:10px;width:10px;background:#ccc;border-radius:50%;margin:0 5px;transition:background-color .3s}
    .step.active{background:#4caf50}
    .language-switcher{position:absolute;top:20px;right:20px}
    .lang-btn{background:#e0e0e0;color:#333;padding:8px 12px;border:1px solid #ccc;border-radius:5px;cursor:pointer;font-size:14px;transition:background-color .3s}
    .lang-btn.active{background:#4caf50;color:#fff}
    .thank-you-page{display:none;text-align:center;animation:fadeIn .5s ease-in-out}
    .thank-you-page h2{font-size:2.2em;color:#4caf50}
    .thank-you-page p{font-size:1.1em;color:#555}
    input.invalid, select.invalid, textarea.invalid{border-color:#d32f2f; box-shadow:0 0 0 2px rgba(211,47,47,.12)}
  </style>
</head>
<body>

  <div class="form-container">
    <!-- Fallback Ï‡Ï‰ÏÎ¯Ï‚ JS -->
    <form id="assistant-form"
          action="/create-assistant"
          method="post"
          enctype="multipart/form-data"
          novalidate>

      <div class="steps-indicator">
        <span class="step active"></span>
        <span class="step"></span>
        <span class="step"></span>
        <span class="step"></span>
      </div>

      <!-- Î’Î®Î¼Î± 1 (EL) -->
      <div class="form-page active" data-lang="el">
        <h2>Î’Î±ÏƒÎ¹ÎºÎ­Ï‚ Î Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚</h2>
        <label for="company-name-el">Î ÏÏ‚ Î»Î­Î³ÎµÏ„Î±Î¹ Î· ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ±Ï‚;</label>
        <input type="text" id="company-name-el" name="companyName" placeholder="Ï€.Ï‡. Google" required>

        <label for="industry-el">Î£Îµ Ï€Î¿Î¹Î± Î²Î¹Î¿Î¼Î·Ï‡Î±Î½Î¯Î± Î´ÏÎ±ÏƒÏ„Î·ÏÎ¹Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ;</label>
        <select id="industry-el" name="industry" required>
          <option value="">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î²Î¹Î¿Î¼Î·Ï‡Î±Î½Î¯Î±...</option>
          <option value="Î¤ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î±">Î¤ÎµÏ‡Î½Î¿Î»Î¿Î³Î¯Î±</option>
          <option value="Î›Î¹Î±Î½Î¹ÎºÏŒ Î•Î¼Ï€ÏŒÏÎ¹Î¿">Î›Î¹Î±Î½Î¹ÎºÏŒ Î•Î¼Ï€ÏŒÏÎ¹Î¿</option>
          <option value="Î¥Î³ÎµÎ¯Î±">Î¥Î³ÎµÎ¯Î±</option>
          <option value="Î•ÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ·">Î•ÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ·</option>
          <option value="Î§ÏÎ·Î¼Î±Ï„Î¿Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÎ¬">Î§ÏÎ·Î¼Î±Ï„Î¿Î¿Î¹ÎºÎ¿Î½Î¿Î¼Î¹ÎºÎ¬</option>
          <option value="Î¤Î¿Ï…ÏÎ¹ÏƒÎ¼ÏŒÏ‚">Î¤Î¿Ï…ÏÎ¹ÏƒÎ¼ÏŒÏ‚</option>
          <option value="ÎœÎµÏ„Î±Ï†Î¿ÏÎ­Ï‚">ÎœÎµÏ„Î±Ï†Î¿ÏÎ­Ï‚</option>
          <option value="ÎšÎ±Ï„Î±ÏƒÎºÎµÏ…Î­Ï‚">ÎšÎ±Ï„Î±ÏƒÎºÎµÏ…Î­Ï‚</option>
          <option value="Î•Î½Î­ÏÎ³ÎµÎ¹Î±">Î•Î½Î­ÏÎ³ÎµÎ¹Î±</option>
          <option value="Î¤ÏÏŒÏ†Î¹Î¼Î± & Î Î¿Ï„Î¬">Î¤ÏÏŒÏ†Î¹Î¼Î± & Î Î¿Ï„Î¬</option>
          <option value="ÎœÏŒÎ´Î± & ÎŸÎ¼Î¿ÏÏ†Î¹Î¬">ÎœÏŒÎ´Î± & ÎŸÎ¼Î¿ÏÏ†Î¹Î¬</option>
          <option value="Î¨Ï…Ï‡Î±Î³Ï‰Î³Î¯Î±">Î¨Ï…Ï‡Î±Î³Ï‰Î³Î¯Î±</option>
          <option value="Î‘Î¸Î»Î·Ï„Î¹ÏƒÎ¼ÏŒÏ‚">Î‘Î¸Î»Î·Ï„Î¹ÏƒÎ¼ÏŒÏ‚</option>
          <option value="ÎÎ¿Î¼Î¹ÎºÎ­Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚">ÎÎ¿Î¼Î¹ÎºÎ­Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚</option>
          <option value="Î£Ï…Î¼Î²Î¿Ï…Î»ÎµÏ…Ï„Î¹ÎºÎ­Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚">Î£Ï…Î¼Î²Î¿Ï…Î»ÎµÏ…Ï„Î¹ÎºÎ­Ï‚ Î¥Ï€Î·ÏÎµÏƒÎ¯ÎµÏ‚</option>
          <option value="Î†Î»Î»Î¿">Î†Î»Î»Î¿</option>
        </select>
        <input type="text" id="industry-other-el" name="industryOther" placeholder="Î Î±ÏÎ±ÎºÎ±Î»Ï Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¯ÏƒÏ„Îµ..." style="display:none;margin-top:10px;">

        <label for="website-el">Î Î¿Î¹Î± ÎµÎ¯Î½Î±Î¹ Î· Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´Î± ÏƒÎ±Ï‚;</label>
        <input type="url" id="website-el" name="websiteURL" placeholder="Ï€.Ï‡. https://www.example.com" required>

        <button type="button" class="next-btn">Î•Ï€ÏŒÎ¼ÎµÎ½Î¿</button>
      </div>

      <!-- Î’Î®Î¼Î± 1 (EN) -->
      <div class="form-page" data-lang="en">
        <h2>Basic Information</h2>
        <label for="company-name-en">What's your company name?</label>
        <input type="text" id="company-name-en" name="companyName" placeholder="e.g. Google" required>

        <label for="industry-en">What industry are you in?</label>
        <select id="industry-en" name="industry" required>
          <option value="">Select industry...</option>
          <option value="Technology">Technology</option>
          <option value="Retail">Retail</option>
          <option value="Healthcare">Healthcare</option>
          <option value="Education">Education</option>
          <option value="Finance">Finance</option>
          <option value="Tourism">Tourism</option>
          <option value="Transportation">Transportation</option>
          <option value="Construction">Construction</option>
          <option value="Energy">Energy</option>
          <option value="Food & Beverage">Food & Beverage</option>
          <option value="Fashion & Beauty">Fashion & Beauty</option>
          <option value="Entertainment">Entertainment</option>
          <option value="Sports">Sports</option>
          <option value="Legal Services">Legal Services</option>
          <option value="Consulting">Consulting</option>
          <option value="Other">Other</option>
        </select>
        <input type="text" id="industry-other-en" name="industryOther" placeholder="Please specify..." style="display:none;margin-top:10px;">

        <label for="website-en">What's your website URL?</label>
        <input type="url" id="website-en" name="websiteURL" placeholder="e.g. https://www.example.com" required>

        <button type="button" class="next-btn">Next</button>
      </div>

      <!-- Î’Î®Î¼Î± 2 (EL) -->
      <div class="form-page" data-lang="el">
        <h2>Î ÎµÏ‚ Î¼Î±Ï‚ Î³Î¹Î± Ï„Î·Î½ ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ¿Ï…</h2>
        <label for="description-el">Î ÏÏ‚ Î¸Î± Ï€ÎµÏÎ¹Î­Î³ÏÎ±Ï†ÎµÏ‚ Ï„Î·Î½ ÎµÏ„Î±Î¹ÏÎµÎ¯Î± ÏƒÎ¿Ï…;</label>
        <textarea id="description-el" name="description" placeholder="Ï€.Ï‡. Î— ÎµÏ„Î±Î¹ÏÎµÎ¯Î± Î¼Î±Ï‚ Î²Î¿Î·Î¸Î¬..." required></textarea>

        <label for="questions-el">Î£Ï…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½ÎµÏ‚ ÎµÏÏ‰Ï„Î®ÏƒÎµÎ¹Ï‚ Ï€ÏÎ¿Ï‚ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚;</label>
        <textarea id="questions-el" name="questions" placeholder="Ï€.Ï‡. Î ÏÏ‚ Î®Ï„Î±Î½ Î· ÎµÎ¼Ï€ÎµÎ¹ÏÎ¯Î± ÏƒÎ±Ï‚;" required></textarea>

        <div class="button-group">
          <button type="button" class="prev-btn">Î Î¯ÏƒÏ‰</button>
          <button type="button" class="next-btn">Î•Ï€ÏŒÎ¼ÎµÎ½Î¿</button>
        </div>
      </div>

      <!-- Î’Î®Î¼Î± 2 (EN) -->
      <div class="form-page" data-lang="en">
        <h2>Tell Us About Your Company</h2>
        <label for="description-en">How would you describe your company?</label>
        <textarea id="description-en" name="description" placeholder="e.g. Our company helps..." required></textarea>

        <label for="questions-en">Specific questions to ask users?</label>
        <textarea id="questions-en" name="questions" placeholder="e.g. How was your experience?" required></textarea>

        <div class="button-group">
          <button type="button" class="prev-btn">Back</button>
          <button type="button" class="next-btn">Next</button>
        </div>
      </div>

      <!-- Î’Î®Î¼Î± 3 (EL) -->
      <div class="form-page" data-lang="el">
        <h2>Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Î£Ï…Î½Î¿Î¼Î¹Î»Î¯Î±Ï‚</h2>
        <label for="end-message-el">Î¤Î¹ Î³Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚ Ï„Î·Ï‚ ÏƒÏ…Î½Î¿Î¼Î¹Î»Î¯Î±Ï‚;</label>
        <textarea id="end-message-el" name="endMessage" placeholder="Ï€.Ï‡. Î•Ï…Ï‡Î±ÏÎ¹ÏƒÏ„Î¿ÏÎ¼Îµ..." required></textarea>

        <label for="greeting-el">Î ÏÏ‚ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Ï‡Î±Î¹ÏÎµÏ„Î¬ÎµÎ¹ Î¿ Î²Î¿Î·Î¸ÏŒÏ‚;</label>
        <textarea id="greeting-el" name="greeting" placeholder="Ï€.Ï‡. Î“ÎµÎ¹Î± ÏƒÎ±Ï‚, Ï€ÏÏ‚ Î¼Ï€Î¿ÏÏ..." required></textarea>

        <div class="button-group">
          <button type="button" class="prev-btn">Î Î¯ÏƒÏ‰</button>
          <button type="button" class="next-btn">Î•Ï€ÏŒÎ¼ÎµÎ½Î¿</button>
        </div>
      </div>

      <!-- Î’Î®Î¼Î± 3 (EN) -->
      <div class="form-page" data-lang="en">
        <h2>Conversation Settings</h2>
        <label for="end-message-en">What should happen at the end?</label>
        <textarea id="end-message-en" name="endMessage" placeholder="e.g. Thanks for your time." required></textarea>

        <label for="greeting-en">How should the assistant greet?</label>
        <textarea id="greeting-en" name="greeting" placeholder="e.g. Hi, how can I help you?" required></textarea>

        <div class="button-group">
          <button type="button" class="prev-btn">Back</button>
          <button type="button" class="next-btn">Next</button>
        </div>
      </div>

      <!-- Î’Î®Î¼Î± 4 (EL) -->
      <div class="form-page" data-lang="el">
        <h2>Î‘Î½Î­Î²Î±ÏƒÎ¼Î± Î‘ÏÏ‡ÎµÎ¯Ï‰Î½</h2>
        <p>ÎœÏ€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î½ÎµÎ²Î¬ÏƒÎµÏ„Îµ Î±ÏÏ‡ÎµÎ¯Î± (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ).</p>
        <label for="files-upload">Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î±ÏÏ‡ÎµÎ¯Î± (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ):</label>
        <input type="file" id="files-upload" name="files" multiple>

        <label for="file-description-el">Î›Î­Î¾ÎµÎ¹Ï‚-ÎºÎ»ÎµÎ¹Î´Î¹Î¬:</label>
        <textarea id="file-description-el" name="keywords" placeholder="Î”ÏÏƒÏ„Îµ Î»Î­Î¾ÎµÎ¹Ï‚-ÎºÎ»ÎµÎ¹Î´Î¹Î¬ Ï€Î¿Ï… ÏƒÏ‡ÎµÏ„Î¯Î¶Î¿Î½Ï„Î±Î¹ Î¼Îµ Ï„Î·Î½ ÎµÏ€Î¹Ï‡ÎµÎ¯ÏÎ·ÏƒÎ® ÏƒÎ±Ï‚" required></textarea>

        <div class="button-group">
          <button type="button" class="prev-btn">Î Î¯ÏƒÏ‰</button>
          <button type="submit" id="submit-btn">Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î’Î¿Î·Î¸Î¿Ï</button>
        </div>
      </div>

      <!-- Î’Î®Î¼Î± 4 (EN) -->
      <div class="form-page" data-lang="en">
        <h2>Upload Files</h2>
        <p>You can upload files (optional).</p>
        <label for="files-upload-en">Select files (optional):</label>
        <input type="file" id="files-upload-en" name="files" multiple>

        <label for="file-description-en">Keywords:</label>
        <textarea id="file-description-en" name="keywords" placeholder="e.g., enter keywords related to your business" required></textarea>

        <div class="button-group">
          <button type="button" class="prev-btn">Back</button>
          <button type="submit" id="submit-btn-en">Create Your Assistant</button>
        </div>
      </div>

    </form>

    <div class="thank-you-page" id="thank-you-page">
      <h2>Î•Ï…Ï‡Î±ÏÎ¹ÏƒÏ„Î¿ÏÎ¼Îµ! ğŸ‰</h2>
      <p>Î— Ï†ÏŒÏÎ¼Î± ÏƒÎ±Ï‚ Ï…Ï€Î¿Î²Î»Î®Î¸Î·ÎºÎµ Î¼Îµ ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î±.</p>
    </div>

    <div class="language-switcher">
      <button id="lang-el" class="lang-btn active">Î•Î»Î»Î·Î½Î¹ÎºÎ¬</button>
      <button id="lang-en" class="lang-btn">English</button>
    </div>
  </div>

  <script>
    console.log('[form] JS loaded');

    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('assistant-form');
      const formPages = document.querySelectorAll('.form-page');
      const steps = document.querySelectorAll('.step');
      const nextButtons = document.querySelectorAll('.next-btn');
      const prevButtons = document.querySelectorAll('.prev-btn');
      const langButtons = document.querySelectorAll('.lang-btn');
      const thankYouPage = document.getElementById('thank-you-page');

      const industrySelectEl = document.getElementById('industry-el');
      const industrySelectEn = document.getElementById('industry-en');
      const industryOtherEl = document.getElementById('industry-other-el');
      const industryOtherEn = document.getElementById('industry-other-en');

      if (industrySelectEl) {
        industrySelectEl.addEventListener('change', function(){
          if (this.value === 'Î†Î»Î»Î¿') { industryOtherEl.style.display='block'; industryOtherEl.required=true; }
          else { industryOtherEl.style.display='none'; industryOtherEl.required=false; industryOtherEl.value=''; }
        });
      }
      if (industrySelectEn) {
        industrySelectEn.addEventListener('change', function(){
          if (this.value === 'Other') { industryOtherEn.style.display='block'; industryOtherEn.required=true; }
          else { industryOtherEn.style.display='none'; industryOtherEn.required=false; industryOtherEn.value=''; }
        });
      }

      document.querySelectorAll('input, textarea, select').forEach(el=>{
        el.addEventListener('input', ()=> el.classList.remove('invalid'));
        el.addEventListener('change', ()=> el.classList.remove('invalid'));
      });

      let currentPage = 0;    // 0..3
      let currentLang = 'el'; // 'el' | 'en'

      const showPage = () => {
        formPages.forEach(page => {
          const pageLang = page.getAttribute('data-lang');
          const pageIndex = Math.floor(Array.from(formPages).indexOf(page) / 2);
          const isActive = (pageIndex === currentPage && pageLang === currentLang);
          page.style.display = isActive ? 'block' : 'none';
          page.classList.toggle('active', isActive);
        });
        steps.forEach((s, i)=> s.classList.toggle('active', i===currentPage));
      };

      const validateCurrentPage = () => {
        const activePage = document.querySelector('.form-page.active');
        if (!activePage) return false;

        let fields = [...activePage.querySelectorAll('input[required], select[required], textarea[required]')];
        if (currentPage === 3) fields = fields.filter(f => f.type !== 'file');

        let firstInvalid = null;
        fields.forEach(f=>{
          const ok = (f.value ?? '').trim().length > 0;
          f.classList.toggle('invalid', !ok);
          if (!ok && !firstInvalid) firstInvalid = f;
        });

        const industrySelect = activePage.querySelector('select[name="industry"]');
        if (industrySelect && (industrySelect.value === 'Î†Î»Î»Î¿' || industrySelect.value === 'Other')) {
          const otherInput = activePage.querySelector('input[name="industryOther"]');
          const ok = otherInput && (otherInput.value ?? '').trim().length > 0;
          if (!ok) { otherInput.classList.add('invalid'); if (!firstInvalid) firstInvalid = otherInput; }
          else { otherInput.classList.remove('invalid'); }
        }

        if (firstInvalid) {
          firstInvalid.scrollIntoView({behavior:'smooth', block:'center'});
          firstInvalid.focus();
          return false;
        }
        return true;
      };

      const handleNext = () => {
        if (!validateCurrentPage()) {
          alert(currentLang==='el' ? 'Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ ÏŒÎ»Î± Ï„Î± Ï€ÎµÎ´Î¯Î± Î³Î¹Î± Î½Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÏ„Îµ.' : 'Please fill in all fields to continue.');
          return;
        }
        if (currentPage < 3) { currentPage++; showPage(); }
      };
      const handlePrev = () => { if (currentPage > 0) { currentPage--; showPage(); } };

      nextButtons.forEach(btn => btn.addEventListener('click', handleNext));
      prevButtons.forEach(btn => btn.addEventListener('click', handlePrev));

      const handleLanguageChange = (lang) => {
        currentLang = lang;
        langButtons.forEach(b=>b.classList.remove('active'));
        document.getElementById(`lang-${lang}`).classList.add('active');
        showPage();
      };
      langButtons.forEach(button=>{
        button.addEventListener('click', (e)=>handleLanguageChange(e.target.id.replace('lang-','')));
      });

      // ===== Î¥Ï€Î¿Î²Î¿Î»Î® =====
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        console.log('[submit] start');

        if (!validateCurrentPage()) {
          console.warn('[submit] validation failed on page', currentPage, 'lang', currentLang);
          alert(currentLang==='el'
            ? 'Î Î±ÏÎ±ÎºÎ±Î»Ï ÏƒÏ…Î¼Ï€Î»Î·ÏÏÏƒÏ„Îµ ÏŒÎ»Î± Ï„Î± Ï€ÎµÎ´Î¯Î± Î³Î¹Î± Î½Î± ÏƒÏ…Î½ÎµÏ‡Î¯ÏƒÎµÏ„Îµ.'
            : 'Please fill in all fields to continue.');
          return;
        }

        const formData = new FormData();

        function pickValueByName(name) {
          const candidates = [...form.querySelectorAll(`[name="${name}"]`)];
          if (!candidates.length) return '';
          const preferred = candidates.find(i => i.id?.endsWith(currentLang)) || candidates[0];
          const other     = candidates.find(i => !i.id?.endsWith(currentLang));
          return (preferred?.value || '').trim() || (other?.value || '').trim() || '';
        }

        function getIndustryValue() {
          const selCandidates = [...form.querySelectorAll('select[name="industry"]')];
          const selPreferred  = selCandidates.find(i => i.id?.endsWith(currentLang)) || selCandidates[0];
          let val = (selPreferred?.value || '').trim();
          if (val === 'Î†Î»Î»Î¿' || val === 'Other' || !val) {
            const otherCandidates = [...form.querySelectorAll('input[name="industryOther"]')];
            const otherPreferred  = otherCandidates.find(i => i.id?.endsWith(currentLang)) || otherCandidates[0];
            const otherVal = (otherPreferred?.value || '').trim();
            if (otherVal) val = otherVal;
          }
          return val;
        }

        const requiredNames = ['companyName','websiteURL','description','questions','endMessage','greeting','keywords'];
        requiredNames.forEach(n => {
          const v = pickValueByName(n);
          if (v) formData.set(n, v);
        });

        const industryVal = getIndustryValue();
        if (industryVal) formData.set('industry', industryVal);

        const fileInput = document.querySelector('.form-page.active input[type="file"]');
        if (fileInput && fileInput.files && fileInput.files.length) {
          for (let i = 0; i < fileInput.files.length; i++) formData.append('files', fileInput.files[i]);
        }

        console.log('[submit] keys:', [...formData.keys()]);

        const submitBtn = document.querySelector('.form-page.active button[type="submit"]');
        const originalText = submitBtn?.textContent || '';
        if (submitBtn) { submitBtn.disabled = true; submitBtn.textContent = currentLang==='el' ? 'Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î±...' : 'Creating...'; }

        try {
          const res = await fetch('/create-assistant', { method:'POST', body: formData });
          const text = await res.text();
          console.log('[submit] status:', res.status, text);

          if (!res.ok) {
            alert((currentLang==='el' ? 'Î£Ï†Î¬Î»Î¼Î±: ' : 'Error: ') + text);
            if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = originalText; }
            return;
          }

          // ===== Î•Ï€Î¹Ï„Ï…Ï‡Î¯Î±: Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· & redirect ÏƒÏ„Î¿ chatbot =====
          let data = {};
          try { data = JSON.parse(text); } catch { data = {}; }
          const received = data.received || {};
          const scraped  = data.scraped  || null;

          sessionStorage.setItem('companyData', JSON.stringify({
            received_data: received,
            scraped: scraped
          }));

          // redirect ÏƒÏ„Î¿ chatbot (Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ companyName ÏƒÎ±Î½ id)
          window.location.href = '/chatbot/' + encodeURIComponent(received.companyName || 'session');

        } catch (err) {
          console.error('[submit] fetch failed:', err);
          alert(currentLang==='el' ? 'Î ÏÎ¿Î­ÎºÏ…ÏˆÎµ ÏƒÏ†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ Ï…Ï€Î¿Î²Î¿Î»Î®.' : 'An error occurred while submitting.');
          if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = originalText; }
        }
      });

      showPage();
    });
  </script>
</body>
</html>
